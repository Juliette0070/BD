db.sessions.insertOne({
    theaterId: 1,
    name: "Concert de jazz",
    start: new Date("2025-01-20T20:00:00Z"),
    end: new Date("2025-01-20T22:00:00Z"),
    price: 20,
    seatsAvailable: 30,
    seats: [
        [0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0]
    ],
    reservations: []
})

db.sessions.find({theaterId: 1})



// vérifier que les places sont disponibles
// si dispo, réserver
var dispo = db.sessions.find({theaterId: 1, name: "Concert de jazz", "seats.1.0": 0, "seats.1.1": 0}).count() == 1
if (dispo) {
    db.sessions.updateOne({theaterId: 1, name: "Concert de jazz"}, {
        $set: {
            "seats.1.0": 1,
            "seats.1.1": 1
        },
        $push: {
            reservations: {
                seats: [[1, 0], [1, 1]],
                price: 20,
                total: 40
            }
        },
        $inc: {
            seatsAvailable: -2
        }
    })
}

db.sessions.find({theaterId: 1, name: "Concert de jazz"})
